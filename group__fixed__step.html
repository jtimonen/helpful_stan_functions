<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Helpful Stan Functions: Explicit fixed-step methods</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Helpful Stan Functions
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Explicit fixed-step methods<div class="ingroups"><a class="el" href="group__odeint.html">ODE solvers</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga3ec8fa6ef1ee5b726c9c9f6c95fc6f29"><td class="memItemLeft" align="right" valign="top">vector[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#ga3ec8fa6ef1ee5b726c9c9f6c95fc6f29">odeint_euler</a> (real t0, vector y0, data real h, data int num_steps, int[] a0, vector theta)</td></tr>
<tr class="separator:ga3ec8fa6ef1ee5b726c9c9f6c95fc6f29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaba5b3bef4d52f98a21db029436d83bd7"><td class="memItemLeft" align="right" valign="top">vector[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#gaba5b3bef4d52f98a21db029436d83bd7">odeint_midpoint</a> (real t0, vector y0, data real h, data int num_steps, int[] a0, vector theta)</td></tr>
<tr class="separator:gaba5b3bef4d52f98a21db029436d83bd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac74c5da9363070d83dd681a4abf92b61"><td class="memItemLeft" align="right" valign="top">vector[]&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#gac74c5da9363070d83dd681a4abf92b61">odeint_rk4</a> (real t0, vector y0, data real h, data int num_steps, int[] a0, vector theta)</td></tr>
<tr class="separator:gac74c5da9363070d83dd681a4abf92b61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These are explicit fixed-step ODE integrators, which evaluate the solution at an equispaced grid of time points. Interpolation can then be used to get the solution at other desired output time points. The functions assume that <code>derivative_fun()</code>, which is the system function of the ODE, is defined earlier in the functions block. It must have signature</p>
<p><code>vector derivative_fun(real t, vector y, int[] a0, vector a1)</code></p>
<p>i.e. same as what can be used with the <a href="https://mc-stan.org/docs/2_26/stan-users-guide/coding-the-ode-system-function.html">built-in ODE solvers</a> of Stan. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga3ec8fa6ef1ee5b726c9c9f6c95fc6f29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3ec8fa6ef1ee5b726c9c9f6c95fc6f29">&#9670;&nbsp;</a></span>odeint_euler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector [] odeint_euler </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int[]&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>Forward Euler method</b></p>
<p>Info: <a href="https://en.wikipedia.org/wiki/Euler_method">https://en.wikipedia.org/wiki/Euler_method</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
<a id="gaba5b3bef4d52f98a21db029436d83bd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaba5b3bef4d52f98a21db029436d83bd7">&#9670;&nbsp;</a></span>odeint_midpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector [] odeint_midpoint </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int[]&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>Explicit midpoint method</b></p>
<p>Info: <a href="https://en.wikipedia.org/wiki/Midpoint_method">https://en.wikipedia.org/wiki/Midpoint_method</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
<a id="gac74c5da9363070d83dd681a4abf92b61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac74c5da9363070d83dd681a4abf92b61">&#9670;&nbsp;</a></span>odeint_rk4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector [] odeint_rk4 </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int[]&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p><b>Fourth-order Runge-Kutta method</b></p>
<p>Info: <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
